<?php

namespace Database\Factories;

use App\Models\Product;
use App\Models\Producer;
use Illuminate\Database\Eloquent\Factories\Factory;
use Illuminate\Support\Str;

class ProductFactory extends Factory
{
    /**
     * The name of the factory's corresponding model.
     *
     * @var string
     */
    protected $model = Product::class;

    /**
     * Define the model's default state.
     *
     * @return array
     */
    public function definition()
    {
        // Realistic Greek products by category
        $greekProducts = [
            'elaiolado' => [
                'Εξαιρετικό Παρθένο Ελαιόλαδο Κορωνέικη',
                'Βιολογικό Ελαιόλαδο Μανάκι Μεσσηνίας',
                'Παραδοσιακό Ελαιόλαδο Καλαμών',
                'Ελαιόλαδο Πρώτης Ψυχρής Έκθλιψης',
                'Κρητικό Ελαιόλαδο Τσουνάτι',
                'Ελαιόλαδο Λεσβιακό Αδραμυτινό',
                'Βιολογικό Ελαιόλαδο Χανίων',
                'Ελαιόλαδο Μυτιλήνης Premium'
            ],
            'elies' => [
                'Καλαμών Ελιές Μαύρες',
                'Χαλκιδικής Ελιές Πράσινες',
                'Κονσερβολιά Αμφίσσης',
                'Βιολογικές Ελιές Θρούμπες',
                'Ελιές Γεμιστές με Αμύγδαλο',
                'Πάστα Ελιάς Καλαμών',
                'Ταπενάντ Μαύρων Ελιών',
                'Ελιές Κρακεδ Πράσινες'
            ],
            'meli' => [
                'Θυμαρίσιο Μέλι Κρήτης',
                'Ανθόμελο Πολυανθικό',
                'Πευκόμελο Εύβοιας',
                'Βιολογικό Μέλι Ερείκης',
                'Μέλι Κάστανου Αρκαδίας',
                'Μέλι Ελάτου Μαίναλου',
                'Μέλι Λεβάντας Νάξου',
                'Μέλι Πορτοκαλιάς Αργολίδας'
            ],
            'tyria' => [
                'Φέτα ΠΟΠ Δωδεκανήσου',
                'Κασέρι Μετσόβου',
                'Γραβιέρα Νάξου',
                'Κεφαλοτύρι Κρήτης',
                'Μανούρι Μακεδονίας',
                'Μυζήθρα Φρέσκια',
                'Ανθότυρο Παραδοσιακό',
                'Σαν Μιχάλη Σύρου'
            ],
            'krasi' => [
                'Ασύρτικο Σαντορίνης',
                'Αγιωργίτικο Νεμέας',
                'Ροδίτης Πατρών',
                'Μοσχοφίλερο Μαντινείας',
                'Ξινόμαυρο Νάουσας',
                'Μαλαγουζιά Χαλκιδικής',
                'Κρασί Ρετσίνα Αττικής',
                'Βιολογικό Κρασί Κρήτης'
            ],
            'zymarika' => [
                'Χειροποίητα Χιλοπίτες',
                'Παραδοσιακά Κριθαράκι',
                'Τραχανάς Ξινός',
                'Λαγάνα Παραδοσιακή',
                'Ζυμαρικά Ολικής Άλεσης',
                'Χειροποίητα Μακαρόνια',
                'Τραχανάς Γλυκός',
                'Φιδές Παραδοσιακά'
            ],
            'marmelades' => [
                'Μαρμελάδα Βερίκοκο Τήνου',
                'Γλυκό Κουταλιού Κεράσι',
                'Μαρμελάδα Σύκο Κρήτης',
                'Γλυκό Κουταλιού Καρπούζι',
                'Μαρμελάδα Πορτοκάλι Αργολίδας',
                'Γλυκό Κουταλιού Τριαντάφυλλο',
                'Μαρμελάδα Κυδώνι',
                'Γλυκό Κουταλιού Γλυκό Κολοκύθα'
            ],
            'baharika' => [
                'Ρίγανη Κρητική',
                'Θυμάρι Ύμηττου',
                'Δυόσμος Αποξηραμένος',
                'Δάφνη Φύλλα',
                'Μαϊντανός Αποξηραμένος',
                'Βασιλικός Αποξηραμένος',
                'Κρεμμύδι Σκόνη',
                'Σκόρδο Σκόνη'
            ],
            'xiroi-karpoi' => [
                'Αμύγδαλα Αλμυρού',
                'Καρύδια Πηλίου',
                'Φιστίκια Αιγίνης',
                'Σταφίδες Κορινθιακές',
                'Σύκα Αποξηραμένα Κρήτης',
                'Κουκουνάρια Πεύκου',
                'Φουντούκια Εύβοιας',
                'Δαμάσκηνα Αποξηραμένα'
            ],
            'aleura' => [
                'Άλευρο Σκληρού Σιταριού',
                'Άλευρο Ολικής Άλεσης',
                'Άλευρο Βρώμης Βιολογικό',
                'Άλευρο Κριθαριού',
                'Άλευρο Ντίνκελ',
                'Άλευρο Καλαμποκιού',
                'Άλευρο Ρυζιού',
                'Άλευρο Φαγόπυρου'
            ]
        ];

        // Product descriptions by category
        $descriptions = [
            'elaiolado' => [
                'Εξαιρετικό παρθένο ελαιόλαδο από επιλεγμένες ελιές, παραγόμενο με παραδοσιακές μεθόδους. Πλούσια γεύση και άρωμα που χαρακτηρίζει την ελληνική γη.',
                'Βιολογικό ελαιόλαδο πρώτης ψυχρής έκθλιψης, χωρίς χημικά λιπάσματα. Ιδανικό για σαλάτες και μαγείρεμα.',
                'Παραδοσιακό ελαιόλαδο από οικογενειακούς ελαιώνες με ιστορία αιώνων. Χαμηλή οξύτητα και εξαιρετική ποιότητα.'
            ],
            'elies' => [
                'Επιλεγμένες ελιές από τους καλύτερους ελαιώνες της Ελλάδας. Φυσική επεξεργασία χωρίς συντηρητικά.',
                'Παραδοσιακές ελιές με μοναδική γεύση και υφή. Ιδανικές για μεζέδες και σαλάτες.',
                'Βιολογικές ελιές καλλιεργημένες με σεβασμό στο περιβάλλον και την παράδοση.'
            ],
            'meli' => [
                'Φυσικό μέλι από ελληνικές κυψέλες, πλούσιο σε βιταμίνες και μέταλλα. Συλλέγεται με παραδοσιακές μεθόδους.',
                'Αγνό μέλι χωρίς επεξεργασία, διατηρεί όλες τις θρεπτικές του ιδιότητες. Μοναδική γεύση και άρωμα.',
                'Βιολογικό μέλι από περιοχές με πλούσια βλάστηση, ελεγμένο για την ποιότητα και την αγνότητά του.'
            ],
            'tyria' => [
                'Παραδοσιακό ελληνικό τυρί από αγνό γάλα, ωριμασμένο με φυσικές μεθόδους. Πλούσια γεύση και άρωμα.',
                'Τυρί ΠΟΠ με πιστοποίηση προέλευσης, παραγόμενο σύμφωνα με παραδοσιακές συνταγές αιώνων.',
                'Βιολογικό τυρί από ελεύθερα βοσκόμενα ζώα, χωρίς χημικά πρόσθετα και συντηρητικά.'
            ],
            'krasi' => [
                'Εκλεκτό ελληνικό κρασί από αυτόχθονες ποικιλίες σταφυλιών. Παραδοσιακή οινοποίηση και μοναδική γεύση.',
                'Κρασί από επιλεγμένους αμπελώνες με ιδανικές κλιματικές συνθήκες. Ισορροπημένη γεύση και άρωμα.',
                'Βιολογικό κρασί από βιώσιμη καλλιέργεια, χωρίς χημικά λιπάσματα και φυτοφάρμακα.'
            ],
            'zymarika' => [
                'Χειροποίητα ζυμαρικά από σκληρό σιτάρι, παραγόμενα με παραδοσιακές μεθόδους. Εξαιρετική υφή και γεύση.',
                'Παραδοσιακά ζυμαρικά από επιλεγμένα υλικά, ιδανικά για αυθεντικές ελληνικές συνταγές.',
                'Βιολογικά ζυμαρικά από άλευρο ολικής άλεσης, πλούσια σε θρεπτικά συστατικά.'
            ],
            'marmelades' => [
                'Σπιτική μαρμελάδα από φρέσκα φρούτα, χωρίς συντηρητικά και τεχνητά χρώματα. Παραδοσιακή συνταγή.',
                'Γλυκό κουταλιού από επιλεγμένα φρούτα, παραγόμενο με φυσικές μεθόδους και αγάπη.',
                'Βιολογική μαρμελάδα από φρούτα βιολογικής καλλιέργειας, χωρίς χημικά πρόσθετα.'
            ],
            'baharika' => [
                'Αρωματικά βότανα από την ελληνική φύση, αποξηραμένα φυσικά και διατηρημένα σωστά.',
                'Παραδοσιακά μπαχαρικά από επιλεγμένες περιοχές, με έντονο άρωμα και γεύση.',
                'Βιολογικά βότανα από άγρια συλλογή, χωρίς χημικές επεμβάσεις.'
            ],
            'xiroi-karpoi' => [
                'Επιλεγμένοι ξηροί καρποί από τους καλύτερους παραγωγούς, πλούσιοι σε θρεπτικά συστατικά.',
                'Φυσικά αποξηραμένα φρούτα χωρίς ζάχαρη και συντηρητικά, διατηρούν όλες τις βιταμίνες.',
                'Βιολογικοί ξηροί καρποί από βιώσιμη καλλιέργεια, ιδανικοί για υγιεινά σνακ.'
            ],
            'aleura' => [
                'Άλευρο από επιλεγμένα σιτηρά, αλεσμένο παραδοσιακά για διατήρηση των θρεπτικών συστατικών.',
                'Βιολογικό άλευρο από σιτηρά βιολογικής καλλιέργειας, ιδανικό για ψωμί και ζυμαρικά.',
                'Άλευρο ολικής άλεσης πλούσιο σε φυτικές ίνες και βιταμίνες, για υγιεινή διατροφή.'
            ]
        ];

        // Default to random category if not specified
        $selectedCategory = $this->faker->randomElement(array_keys($greekProducts));
        $productName = $this->faker->randomElement($greekProducts[$selectedCategory]);
        $description = $this->faker->randomElement($descriptions[$selectedCategory]);

        // Price ranges by category
        $priceRanges = [
            'elaiolado' => [8, 25],
            'elies' => [4, 12],
            'meli' => [6, 18],
            'tyria' => [5, 20],
            'krasi' => [12, 45],
            'zymarika' => [3, 8],
            'marmelades' => [4, 10],
            'baharika' => [2, 6],
            'xiroi-karpoi' => [5, 15],
            'aleura' => [2, 5]
        ];

        $priceRange = $priceRanges[$selectedCategory];
        $price = $this->faker->randomFloat(2, $priceRange[0], $priceRange[1]);

        // Make slug unique by adding random suffix
        $baseSlug = Str::slug($productName);
        $uniqueSlug = $baseSlug . '-' . $this->faker->unique()->numberBetween(1000, 9999);

        return [
            'producer_id' => Producer::factory(),
            'name' => $productName,
            'slug' => $uniqueSlug,
            'description' => $description,
            'short_description' => $this->faker->sentence,
            'price' => $price,
            'stock' => $this->faker->numberBetween(5, 100),
            'weight_grams' => $this->faker->numberBetween(200, 2000),
            'dimensions' => json_encode([
                'length_cm' => $this->faker->numberBetween(8, 30),
                'width_cm' => $this->faker->numberBetween(8, 30),
                'height_cm' => $this->faker->numberBetween(5, 25),
            ]),
            'is_active' => $this->faker->boolean(95), // 95% active
            'created_at' => now(),
            'updated_at' => now(),
        ];
    }

    /**
     * Create products for a specific category
     */
    public function forCategory(string $categorySlug)
    {
        return $this->state(function (array $attributes) use ($categorySlug) {
            // Greek products by category
            $greekProducts = [
                'elaiolado' => [
                    'Εξαιρετικό Παρθένο Ελαιόλαδο Κορωνέικη',
                    'Βιολογικό Ελαιόλαδο Μανάκι Μεσσηνίας',
                    'Παραδοσιακό Ελαιόλαδο Καλαμών',
                    'Ελαιόλαδο Πρώτης Ψυχρής Έκθλιψης',
                    'Κρητικό Ελαιόλαδο Τσουνάτι',
                    'Ελαιόλαδο Λεσβιακό Αδραμυτινό',
                    'Βιολογικό Ελαιόλαδο Χανίων',
                    'Ελαιόλαδο Μυτιλήνης Premium'
                ],
                'elies' => [
                    'Καλαμών Ελιές Μαύρες',
                    'Χαλκιδικής Ελιές Πράσινες',
                    'Κονσερβολιά Αμφίσσης',
                    'Βιολογικές Ελιές Θρούμπες',
                    'Ελιές Γεμιστές με Αμύγδαλο',
                    'Πάστα Ελιάς Καλαμών',
                    'Ταπενάντ Μαύρων Ελιών',
                    'Ελιές Κρακεδ Πράσινες'
                ],
                'meli' => [
                    'Θυμαρίσιο Μέλι Κρήτης',
                    'Ανθόμελο Πολυανθικό',
                    'Πευκόμελο Εύβοιας',
                    'Βιολογικό Μέλι Ερείκης',
                    'Μέλι Κάστανου Αρκαδίας',
                    'Μέλι Ελάτου Μαίναλου',
                    'Μέλι Λεβάντας Νάξου',
                    'Μέλι Πορτοκαλιάς Αργολίδας'
                ],
                'tyria' => [
                    'Φέτα ΠΟΠ Δωδεκανήσου',
                    'Κασέρι Μετσόβου',
                    'Γραβιέρα Νάξου',
                    'Κεφαλοτύρι Κρήτης',
                    'Μανούρι Μακεδονίας',
                    'Μυζήθρα Φρέσκια',
                    'Ανθότυρο Παραδοσιακό',
                    'Σαν Μιχάλη Σύρου'
                ],
                'krasi' => [
                    'Ασύρτικο Σαντορίνης',
                    'Αγιωργίτικο Νεμέας',
                    'Ροδίτης Πατρών',
                    'Μοσχοφίλερο Μαντινείας',
                    'Ξινόμαυρο Νάουσας',
                    'Μαλαγουζιά Χαλκιδικής',
                    'Κρασί Ρετσίνα Αττικής',
                    'Βιολογικό Κρασί Κρήτης'
                ],
                'zymarika' => [
                    'Χειροποίητα Χιλοπίτες',
                    'Παραδοσιακά Κριθαράκι',
                    'Τραχανάς Ξινός',
                    'Λαγάνα Παραδοσιακή',
                    'Ζυμαρικά Ολικής Άλεσης',
                    'Χειροποίητα Μακαρόνια',
                    'Τραχανάς Γλυκός',
                    'Φιδές Παραδοσιακά'
                ],
                'marmelades' => [
                    'Μαρμελάδα Βερίκοκο Τήνου',
                    'Γλυκό Κουταλιού Κεράσι',
                    'Μαρμελάδα Σύκο Κρήτης',
                    'Γλυκό Κουταλιού Καρπούζι',
                    'Μαρμελάδα Πορτοκάλι Αργολίδας',
                    'Γλυκό Κουταλιού Τριαντάφυλλο',
                    'Μαρμελάδα Κυδώνι',
                    'Γλυκό Κουταλιού Γλυκό Κολοκύθα'
                ],
                'baharika' => [
                    'Ρίγανη Κρητική',
                    'Θυμάρι Ύμηττου',
                    'Δυόσμος Αποξηραμένος',
                    'Δάφνη Φύλλα',
                    'Μαϊντανός Αποξηραμένος',
                    'Βασιλικός Αποξηραμένος',
                    'Κρεμμύδι Σκόνη',
                    'Σκόρδο Σκόνη'
                ],
                'xiroi-karpoi' => [
                    'Αμύγδαλα Αλμυρού',
                    'Καρύδια Πηλίου',
                    'Φιστίκια Αιγίνης',
                    'Σταφίδες Κορινθιακές',
                    'Σύκα Αποξηραμένα Κρήτης',
                    'Κουκουνάρια Πεύκου',
                    'Φουντούκια Εύβοιας',
                    'Δαμάσκηνα Αποξηραμένα'
                ],
                'aleura' => [
                    'Άλευρο Σκληρού Σιταριού',
                    'Άλευρο Ολικής Άλεσης',
                    'Άλευρο Βρώμης Βιολογικό',
                    'Άλευρο Κριθαριού',
                    'Άλευρο Ντίνκελ',
                    'Άλευρο Καλαμποκιού',
                    'Άλευρο Ρυζιού',
                    'Άλευρο Φαγόπυρου'
                ]
            ];

            // Product descriptions by category
            $descriptions = [
                'elaiolado' => [
                    'Εξαιρετικό παρθένο ελαιόλαδο από επιλεγμένες ελιές, παραγόμενο με παραδοσιακές μεθόδους. Πλούσια γεύση και άρωμα που χαρακτηρίζει την ελληνική γη.',
                    'Βιολογικό ελαιόλαδο πρώτης ψυχρής έκθλιψης, χωρίς χημικά λιπάσματα. Ιδανικό για σαλάτες και μαγείρεμα.',
                    'Παραδοσιακό ελαιόλαδο από οικογενειακούς ελαιώνες με ιστορία αιώνων. Χαμηλή οξύτητα και εξαιρετική ποιότητα.'
                ],
                'elies' => [
                    'Επιλεγμένες ελιές από τους καλύτερους ελαιώνες της Ελλάδας. Φυσική επεξεργασία χωρίς συντηρητικά.',
                    'Παραδοσιακές ελιές με μοναδική γεύση και υφή. Ιδανικές για μεζέδες και σαλάτες.',
                    'Βιολογικές ελιές καλλιεργημένες με σεβασμό στο περιβάλλον και την παράδοση.'
                ],
                'meli' => [
                    'Φυσικό μέλι από ελληνικές κυψέλες, πλούσιο σε βιταμίνες και μέταλλα. Συλλέγεται με παραδοσιακές μεθόδους.',
                    'Αγνό μέλι χωρίς επεξεργασία, διατηρεί όλες τις θρεπτικές του ιδιότητες. Μοναδική γεύση και άρωμα.',
                    'Βιολογικό μέλι από περιοχές με πλούσια βλάστηση, ελεγμένο για την ποιότητα και την αγνότητά του.'
                ],
                'tyria' => [
                    'Παραδοσιακό ελληνικό τυρί από αγνό γάλα, ωριμασμένο με φυσικές μεθόδους. Πλούσια γεύση και άρωμα.',
                    'Τυρί ΠΟΠ με πιστοποίηση προέλευσης, παραγόμενο σύμφωνα με παραδοσιακές συνταγές αιώνων.',
                    'Βιολογικό τυρί από ελεύθερα βοσκόμενα ζώα, χωρίς χημικά πρόσθετα και συντηρητικά.'
                ],
                'krasi' => [
                    'Εκλεκτό ελληνικό κρασί από αυτόχθονες ποικιλίες σταφυλιών. Παραδοσιακή οινοποίηση και μοναδική γεύση.',
                    'Κρασί από επιλεγμένους αμπελώνες με ιδανικές κλιματικές συνθήκες. Ισορροπημένη γεύση και άρωμα.',
                    'Βιολογικό κρασί από βιώσιμη καλλιέργεια, χωρίς χημικά λιπάσματα και φυτοφάρμακα.'
                ],
                'zymarika' => [
                    'Χειροποίητα ζυμαρικά από σκληρό σιτάρι, παραγόμενα με παραδοσιακές μεθόδους. Εξαιρετική υφή και γεύση.',
                    'Παραδοσιακά ζυμαρικά από επιλεγμένα υλικά, ιδανικά για αυθεντικές ελληνικές συνταγές.',
                    'Βιολογικά ζυμαρικά από άλευρο ολικής άλεσης, πλούσια σε θρεπτικά συστατικά.'
                ],
                'marmelades' => [
                    'Σπιτική μαρμελάδα από φρέσκα φρούτα, χωρίς συντηρητικά και τεχνητά χρώματα. Παραδοσιακή συνταγή.',
                    'Γλυκό κουταλιού από επιλεγμένα φρούτα, παραγόμενο με φυσικές μεθόδους και αγάπη.',
                    'Βιολογική μαρμελάδα από φρούτα βιολογικής καλλιέργειας, χωρίς χημικά πρόσθετα.'
                ],
                'baharika' => [
                    'Αρωματικά βότανα από την ελληνική φύση, αποξηραμένα φυσικά και διατηρημένα σωστά.',
                    'Παραδοσιακά μπαχαρικά από επιλεγμένες περιοχές, με έντονο άρωμα και γεύση.',
                    'Βιολογικά βότανα από άγρια συλλογή, χωρίς χημικές επεμβάσεις.'
                ],
                'xiroi-karpoi' => [
                    'Επιλεγμένοι ξηροί καρποί από τους καλύτερους παραγωγούς, πλούσιοι σε θρεπτικά συστατικά.',
                    'Φυσικά αποξηραμένα φρούτα χωρίς ζάχαρη και συντηρητικά, διατηρούν όλες τις βιταμίνες.',
                    'Βιολογικοί ξηροί καρποί από βιώσιμη καλλιέργεια, ιδανικοί για υγιεινά σνακ.'
                ],
                'aleura' => [
                    'Άλευρο από επιλεγμένα σιτηρά, αλεσμένο παραδοσιακά για διατήρηση των θρεπτικών συστατικών.',
                    'Βιολογικό άλευρο από σιτηρά βιολογικής καλλιέργειας, ιδανικό για ψωμί και ζυμαρικά.',
                    'Άλευρο ολικής άλεσης πλούσιο σε φυτικές ίνες και βιταμίνες, για υγιεινή διατροφή.'
                ]
            ];

            // Price ranges by category
            $priceRanges = [
                'elaiolado' => [8, 25],
                'elies' => [4, 12],
                'meli' => [6, 18],
                'tyria' => [5, 20],
                'krasi' => [12, 45],
                'zymarika' => [3, 8],
                'marmelades' => [4, 10],
                'baharika' => [2, 6],
                'xiroi-karpoi' => [5, 15],
                'aleura' => [2, 5]
            ];

            if (!isset($greekProducts[$categorySlug])) {
                $categorySlug = 'elaiolado'; // fallback
            }

            $productName = $this->faker->randomElement($greekProducts[$categorySlug]);
            $description = $this->faker->randomElement($descriptions[$categorySlug]);
            $priceRange = $priceRanges[$categorySlug];
            $price = $this->faker->randomFloat(2, $priceRange[0], $priceRange[1]);

            // Make slug unique by adding random suffix
            $baseSlug = \Illuminate\Support\Str::slug($productName);
            $uniqueSlug = $baseSlug . '-' . $this->faker->unique()->numberBetween(1000, 9999);

            return [
                'name' => $productName,
                'slug' => $uniqueSlug,
                'description' => $description,
                'price' => $price,
            ];
        });
    }
}
